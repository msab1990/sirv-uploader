
<!-- saved from url=(0118)file:///private/var/folders/hc/gwx2k4pj05q_mz5qkbs1ygvr0000gn/T/com.microsoft.Outlook/Outlook%20Temp/sirv_uploader.htm -->
<html><head>
  
  <meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
  <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/smoothness/jquery-ui.css">
  
  <style>
    #image-categories {
    display: flex;
    justify-content: center;
    gap: 20px;
    flex-wrap: wrap;
    margin: 20px auto;
    max-width: 800px;
}

.category {
    display: flex;
    flex-direction: column;
    align-items: center;
    background: #f9f9f9;
    padding: 15px;
    border-radius: 12px; /* Soft rounded edges */
    border: 2px solid #ddd;
    box-shadow: 2px 4px 10px rgba(0, 0, 0, 0.15);
    width: 140px;
    text-align: center;
    transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
}

.category:hover {
    transform: translateY(-3px);
    box-shadow: 3px 6px 12px rgba(0, 0, 0, 0.2);
}

.category img {
    width: 100px; /* Uniform icon size */
    height: auto;
    border-radius: 8px;
    margin-bottom: 8px;
}

.category p {
    font-size: 14px;
    font-weight: bold;
    color: #333;
    text-transform: capitalize;
    margin: 0;
}

    .uploader-container {
        width: 400px;
        margin: auto;
        text-align: center;
        font-family: Arial, sans-serif;
    }
    
    #drop-area:hover {
        background: #e3e3e3;
    }
    
    #browse-button {
        background: #ff5500;
        color: white;
        border: none;
        padding: 10px 15px;
        cursor: pointer;
    }
    
    #image-preview-list {
        list-style: none;
        padding: 0;
    }
        body {
    font-family: Arial, sans-serif;
    background-color: #f5f5f5;
    margin: 0;
    padding: 20px;
    text-align: center;
}

#drop-area {
    border: 2px dashed #0073e6;
    padding: 20px;
    margin: 20px 0;
    border-radius: 10px;
    background: #f0f8ff;
    transition: background 0.3s ease-in-out;
}

#drop-area:hover {
    background: #e0f0ff;
}

button {
    background: #0073e6;
    color: white;
    border: none;
    padding: 10px 20px;
    border-radius: 5px;
    cursor: pointer;
    transition: background 0.3s;
}

button:hover {
    background: #005bb5;
}

#upload-button2 {
    background: #28a745;
    margin-top: 20px;
}

#upload-status {
    margin-top: 20px;
    font-size: 14px;
    color: #333;
}

h2 {
    color: #333;
}
</style>
</head>
<body>
    <!-- Tapestry Music Logo -->
    <div style="text-align: center; margin-bottom: 20px;">
        <img src="https://www.tapestrymusic.com/images/icon/newtapestrylogo.jpg" alt="Tapestry Music Logo">
    </div>

    <!-- Header -->
    <h2 style="color: #333; margin-top: 0;">Tapestry Music Product Image Uploader</h2>
    <p>Images are automatically converted to JPG format. Please do not upload files larger than 100MB.</p>
    <div id="image-categories">
      <div class="category">
          <img src="https://www.tapestrymusic.com/images/icons/PrimaryPhoto.jpg" alt="Primary Photo">
          <p>Primary Photo</p>
      </div>
      <div class="category">
          <img src="https://www.tapestrymusic.com/images/icons/EveryAngle.jpg" alt="Every Angle">
          <p>Every Angle</p>
      </div>
      <div class="category">
          <img src="https://www.tapestrymusic.com/images/icons/Details.jpg" alt="Details">
          <p>Details</p>
      </div>
      <div class="category">
          <img src="https://www.tapestrymusic.com/images/icons/Imperfections.jpg" alt="Imperfections">
          <p>Imperfections</p>
      </div>
      <div class="category">
          <img src="https://www.tapestrymusic.com/images/icons/InUse.jpg" alt="In Use">
          <p>In Use</p>
      </div>
      <div class="category">
        <img src="https://www.tapestrymusic.com/images/icons/SizeAndScale.jpg" alt="Size and Scale">
          <p>Size and Scale</p>
      </div>
  </div>
  
    <!-- Uploader Container -->
    <div class="uploader-container">
        <h2>Upload Product Images</h2>
        <label for="product_id">Enter Product ID:</label>
        <input type="text" id="product_id" placeholder="Enter product ID">

        <!-- Drag and Drop Area -->
        <div id="drop-area">
            <p>Drag & drop your images here</p>
            <input type="file" id="file-chooser2" multiple hidden>
            <button id="browse-button">Browse Files</button>
        </div>

        <!-- Preview and Sort -->
        <div id="sortable-list">
            <p>Preview & Sort Images:</p>
            <ul id="image-preview-list"></ul>
        </div>

        <!-- Upload Button -->
        <button id="upload-button2">Upload Images</button>
        <div id="upload-status"></div>
<button id="clear-status" style="background: #dc3545; margin-top: 10px;">Clear Upload Status</button>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/aws-sdk/2.1.43/aws-sdk.min.js"></script>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"></script>
<script>
    document.addEventListener("DOMContentLoaded", function() {
        const dropArea = document.getElementById("drop-area");
        const fileChooser = document.getElementById("file-chooser2");
        const browseButton = document.getElementById("browse-button");
        const previewList = document.getElementById("image-preview-list");
        const uploadButton = document.getElementById("upload-button2");
    
        // ✅ Initialize AWS S3 with the correct Sirv bucket name (TapProdImg)
        var s3 = new AWS.S3({
            endpoint: new AWS.Endpoint('https://s3.sirv.com'),
            params: {
                Bucket: 'TapProdImg' // ✅ Your Sirv bucket name
            }
        });
    
        // Function to handle file previews
        function handleFiles(files) {
            previewList.innerHTML = ""; // Clear previous images
            Array.from(files).forEach((file, index) => {
                const li = document.createElement("li");
                li.setAttribute("data-index", index);
                li.style.padding = "5px";
                li.style.cursor = "move"; // Set cursor for drag effect
    
                const reader = new FileReader();
                reader.onload = (e) => {
                    li.innerHTML = `<img src="${e.target.result}" width="80" style="margin-right: 10px;"> ${file.name}`;
                    previewList.appendChild(li);
                };
                reader.readAsDataURL(file);
            });
    
            // Enable drag-and-drop sorting using jQuery UI
            $("#image-preview-list").sortable();
            $("#image-preview-list").disableSelection();
        }
    
        // Handle file selection via button click
        browseButton.addEventListener("click", () => fileChooser.click());
    
        // Handle file selection via input
        fileChooser.addEventListener("change", function(event) {
            handleFiles(event.target.files);
        });
    
        // Drag and drop area styling
        dropArea.addEventListener("dragover", (e) => {
            e.preventDefault();
            dropArea.style.background = "#e3e3e3";
        });
    
        dropArea.addEventListener("dragleave", () => {
            dropArea.style.background = "#f9f9f9";
        });
    
        dropArea.addEventListener("drop", (e) => {
            e.preventDefault();
            dropArea.style.background = "#f9f9f9";
            handleFiles(e.dataTransfer.files);
        });
    
        // Upload button event listener (no duplicate now)
        uploadButton.addEventListener("click", function() {
    if (uploadButton.disabled) return; // Prevent duplicate clicks
    uploadButton.disabled = true; // Disable button during upload
            const files = fileChooser.files;
            if (files.length === 0) {
                alert("No images selected.");
                return;
            }
    
            uploadFiles(files);
        });
    
        // Function to upload images to Sirv
        function uploadFiles(files) {
            let productID = document.getElementById("product_id").value;
            if (!productID) {
                alert("Enter a product ID first.");
                return;
            }
    
            Array.from(files).forEach((file, index) => {
                let extension = file.name.split('.').pop();
                let newFilename = `${productID}_${index + 2}_.${extension}`;
                let objKey = `Large/${newFilename}`; // ✅ Uploads to the "Large" folder inside TapProdImg
    
                let params = {
                    Key: objKey,
                    ContentType: file.type,
                    Body: file
                };
    
                // ✅ Now uploads correctly to TapProdImg/Large
                s3.putObject(params, function(err, data) {
                    if (err) {
                        document.getElementById("upload-status").innerHTML += "Error: " + err.message + "<br>";
                    } else {
                        document.getElementById("upload-status").innerHTML += `<span style="color: green;">✅ Uploaded: ${newFilename}</span><br>`;
                        uploadButton.disabled = false; // Re-enable the button after upload

                    }
                });
            });
        }
    });
    document.getElementById("clear-status").addEventListener("click", function() {
    document.getElementById("upload-status").innerHTML = "";
});

    </script>
    </body>
    </html>
    


